---
output: github_document
---


```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# ripp: R ImPerfect Placebos

<!-- badges: start -->
<!-- badges: end -->

Initial R package for making causal progress with imperfect placebos. See Rohde and Hazlett (20XX) for details.

## Installation

You can install the development version of ripp from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("Adam-Rohde/ripp")
```

## Example

Here is a simple simulated example of how to use a placebo outcome `N` to inform partial identification of the effect of `D` on `Y`. We start by simulating some data. `Z` is an unobserved confounder. Then we fit `lm(Y ~ D)` and `lm(N ~ D)`. Next, we call the `ripp` function, followed by `ripp_summary`, `ripp_contour_plot`, and `ripp_line_plot`. We call `ripp_line_plot` under the assumption that `beta.nd.pxz=0` as well as under the assumption that `beta.nd.pxz=2`, which is the true value in the simulation. 

```{r example}
library(ripp)

data(lalonde,package = "qte")

plm = placeboLM(
  data = "lalonde.psid",
  placebo_data = NULL,
  outcome = "re78",
  treatment = "treat",
  placebo_outcome = "re74",
  placebo_treatment = "",
  DP = "",
  PY = "",
  observed_covariates = c("age", "education", "black", "hispanic", "married", "nodegree"),
  partialIDparam_minmax = list(k = c(-2,2), coef_P_D_given_XZ = c(-15000,15000)))


placeboLM_table(plm,n_boot = 100,ptiles = c(0,0.25,0.5,0.75,1))

placeboLM_contour_plot(plm)


n = 1000
Z = stats::rnorm(n)
D = Z + stats::rnorm(n)
Y = D + Z + stats::rnorm(n)
N = 2*D + 2*Z + stats::rnorm(n)

m_Y_DPX = lm(Y ~ D)
m_N_DPX = lm(N ~ D)

ripper = ripp(type="placebo outcome",lm.y.dpx = m_Y_DPX,lm.n.dpx = m_N_DPX,treatment = "D")

ripp_summary(ripper)

ripp_contour_plot(ripper)

ripp_line_plot(ripper,beta.nd.pxz=0)

ripp_line_plot(ripper,beta.nd.pxz=2)
```
